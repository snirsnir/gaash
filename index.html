<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>בנק המחקרים בנושא הרי געש</title>
    <style>
        :root {
            --primary-color: #ff4500;
            --secondary-color: #333;
            --bg-dark: #1a1a1a;
            --text-light: #f5f5f5;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bg-dark);
            color: var(--text-light);
            overflow-x: hidden;
            position: relative;
        }
        
        /* Volcano Background Animation */
        .volcano-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 0.15;
            background: radial-gradient(circle at 50% 100%, 
                            #ff4500, #ff4500 5%, 
                            #ff6a00 10%, 
                            #8b0000 25%, 
                            #3d0000 40%, 
                            var(--bg-dark) 60%);
        }
        
        .lava-bubble {
            position: absolute;
            bottom: -20px;
            background-color: var(--primary-color);
            border-radius: 50%;
            animation: rise var(--rise-duration) ease-out infinite;
            opacity: 0.6;
        }
        
        @keyframes rise {
            0% {
                transform: translateY(0) scale(1);
                opacity: 0.6;
            }
            100% {
                transform: translateY(-100vh) scale(0);
                opacity: 0;
            }
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
            border-bottom: 2px solid var(--primary-color);
            position: relative;
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(255, 69, 0, 0.7);
        }
        
        .form-container, .thanks-container, .research-bank {
            background-color: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 0 20px rgba(255, 69, 0, 0.3);
        }
        
        h2 {
            margin-bottom: 20px;
            color: var(--primary-color);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
        }
        
        input, button {
            width: 100%;
            padding: 12px;
            border-radius: 5px;
            border: none;
            font-size: 1rem;
        }
        
        input[type="file"] {
            background-color: rgba(255, 255, 255, 0.1);
            cursor: pointer;
        }
        
        button {
            background-color: var(--primary-color);
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s;
            margin-top: 20px;
        }
        
        button:hover {
            background-color: #ff6a00;
        }
        
        .thanks-container {
            text-align: center;
            display: none;
        }
        
        .research-bank {
            display: none;
        }
        
        #bank-link {
            display: block;
            text-align: center;
            color: var(--primary-color);
            margin: 20px 0;
            font-weight: bold;
            text-decoration: none;
            font-size: 1.1rem;
        }
        
        #bank-link:hover {
            text-decoration: underline;
        }
        
        .pdf-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .pdf-item {
            background-color: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 5px;
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s, background-color 0.3s;
        }
        
        .pdf-item:hover {
            transform: translateY(-5px);
            background-color: rgba(255, 69, 0, 0.3);
        }
        
        .pdf-icon {
            width: 60px;
            height: 60px;
            margin-bottom: 10px;
            fill: var(--primary-color);
        }
        
        .pdf-name {
            text-align: center;
            word-break: break-word;
        }
        
        .loader {
            border: 5px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top: 5px solid var(--primary-color);
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
            display: none;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        #pdf-viewer {
            width: 100%;
            height: 600px;
            border: none;
            display: none;
            margin-top: 20px;
        }
        
        .back-button {
            padding: 10px 20px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            margin-bottom: 20px;
            width: auto;
            display: none;
        }
        
        .back-button:hover {
            background-color: #ff6a00;
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 1.8rem;
            }
            
            .form-container, .thanks-container, .research-bank {
                padding: 20px;
            }
            
            .pdf-container {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            #pdf-viewer {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="volcano-bg"></div>
    
    <div class="container">
        <header>
            <h1>בנק המחקרים בנושא הרי געש</h1>
        </header>
        
        <div id="form-section" class="form-container">
            <h2>העלאת מחקר חדש</h2>
            <form id="upload-form">
                <div class="form-group">
                    <label for="group-name">שם הקבוצה:</label>
                    <input type="text" id="group-name" required>
                </div>
                
                <div class="form-group">
                    <label for="pdf-file">טען קובץ PDF בלבד:</label>
                    <input type="file" id="pdf-file" accept=".pdf" required>
                </div>
                
                <button type="submit">שלח</button>
            </form>
            
            <a href="#" id="bank-link">לצפייה בבנק המחקרים</a>
            
            <div class="loader" id="upload-loader"></div>
        </div>
        
        <div id="thanks-section" class="thanks-container">
            <h2>תודה!</h2>
            <p>הקובץ עלה בהצלחה</p>
            <p>תועברו לבנק המחקרים בעוד <span id="countdown">3</span> שניות...</p>
        </div>
        
        <div id="research-bank" class="research-bank">
            <h2>בנק המחקרים</h2>
            <button id="back-to-form" class="back-button">חזרה לטופס העלאה</button>
            
            <div class="loader" id="bank-loader"></div>
            <div id="pdf-container" class="pdf-container"></div>
            
            <button id="back-to-list" class="back-button">חזרה לרשימת המחקרים</button>
            <iframe id="pdf-viewer"></iframe>
        </div>
    </div>
    
    <script>
        // Create lava bubbles for animation
        function createLavaBubbles() {
            const volcanoBackground = document.querySelector('.volcano-bg');
            
            for (let i = 0; i < 20; i++) {
                const bubble = document.createElement('div');
                bubble.classList.add('lava-bubble');
                
                // Random sizes
                const size = Math.random() * 30 + 10;
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                
                // Random horizontal position
                bubble.style.left = `${Math.random() * 100}%`;
                
                // Random animation duration
                const duration = Math.random() * 10 + 5;
                bubble.style.setProperty('--rise-duration', `${duration}s`);
                
                // Random delay
                bubble.style.animationDelay = `${Math.random() * 10}s`;
                
                volcanoBackground.appendChild(bubble);
            }
        }
        
        // Initialize the Google API client
        function initClient() {
            gapi.client.init({
                apiKey: 'YOUR_API_KEY', // You need to replace this with an actual API key
                clientId: 'YOUR_CLIENT_ID', // You need to replace this with an actual client ID
                discoveryDocs: ["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],
                scope: 'https://www.googleapis.com/auth/drive.file'
            }).then(function() {
                console.log('Google API client initialized');
            }).catch(function(error) {
                console.error('Error initializing Google API client', error);
            });
        }
        
        // Upload file to Google Drive
        function uploadFile(file, groupName, callback) {
            const metadata = {
                name: `${groupName} - ${file.name}`,
                mimeType: file.type,
                parents: ['157f4mUJXMfphy-jZCWPC6iurbpSTaOs_'] // Folder ID from your link
            };
            
            const form = new FormData();
            form.append('metadata', new Blob([JSON.stringify(metadata)], {type: 'application/json'}));
            form.append('file', file);
            
            fetch('https://www.googleapis.com/upload/drive/v3/files?uploadType=multipart', {
                method: 'POST',
                headers: new Headers({
                    'Authorization': 'Bearer ' + gapi.auth.getToken().access_token,
                }),
                body: form
            })
            .then(response => response.json())
            .then(data => {
                console.log('File uploaded successfully', data);
                if (callback) callback();
            })
            .catch(error => {
                console.error('Error uploading file', error);
                alert('התרחשה שגיאה בהעלאת הקובץ. אנא נסו שוב מאוחר יותר.');
                document.getElementById('upload-loader').style.display = 'none';
            });
        }
        
        // List files from Google Drive folder
        function listFiles() {
            document.getElementById('bank-loader').style.display = 'block';
            document.getElementById('pdf-container').innerHTML = '';
            
            gapi.client.drive.files.list({
                q: "'157f4mUJXMfphy-jZCWPC6iurbpSTaOs_' in parents and mimeType='application/pdf'",
                fields: 'files(id, name, webViewLink)'
            }).then(function(response) {
                const files = response.result.files;
                const container = document.getElementById('pdf-container');
                
                if (files && files.length > 0) {
                    files.forEach(file => {
                        const pdfItem = document.createElement('div');
                        pdfItem.className = 'pdf-item';
                        pdfItem.dataset.fileId = file.id;
                        pdfItem.dataset.link = file.webViewLink;
                        
                        pdfItem.innerHTML = `
                            <svg class="pdf-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                                <path d="M369.9 97.9L286 14C277 5 264.8-.1 252.1-.1H48C21.5 0 0 21.5 0 48v416c0 26.5 21.5 48 48 48h288c26.5 0 48-21.5 48-48V131.9c0-12.7-5.1-25-14.1-34zM332.1 128H256V51.9l76.1 76.1zM48 464V48h160v104c0 13.3 10.7 24 24 24h104v288H48zm250.2-143.7c-12.2-12-47-8.7-64.4-6.5-17.2-10.5-28.7-25-36.8-46.3 3.9-16.1 10.1-40.6 5.4-56-4.2-26.2-37.8-23.6-42.6-5.9-4.4 16.1-.4 38.5 7 67.1-10 23.9-24.9 56-35.4 74.4-20 10.3-47 26.2-51 46.2-3.3 15.8 26 55.2 76.1-31.2 22.4-7.4 46.8-16.5 68.4-20.1 18.9 10.2 41 17 55.8 17 25.5 0 28-28.2 17.5-38.7zm-198.1 77.8c5.1-13.7 24.5-29.5 30.4-35-19 30.3-30.4 35.7-30.4 35zm81.6-190.6c7.4 0 6.7 32.1 1.8 40.8-4.4-13.9-4.3-40.8-1.8-40.8zm-24.4 136.6c9.7-16.9 18-37 24.7-54.7 8.3 15.1 18.9 27.2 30.1 35.5-20.8 4.3-38.9 13.1-54.8 19.2zm131.6-5s-5 6-37.3-7.8c35.1-2.6 40.9 5.4 37.3 7.8z"/>
                            </svg>
                            <div class="pdf-name">${file.name}</div>
                        `;
                        
                        pdfItem.addEventListener('click', function() {
                            document.getElementById('pdf-container').style.display = 'none';
                            document.getElementById('pdf-viewer').style.display = 'block';
                            document.getElementById('pdf-viewer').src = `https://drive.google.com/file/d/${file.id}/preview`;
                            document.getElementById('back-to-list').style.display = 'block';
                        });
                        
                        container.appendChild(pdfItem);
                    });
                } else {
                    container.innerHTML = '<p>לא נמצאו קבצים בתיקיה.</p>';
                }
                
                document.getElementById('bank-loader').style.display = 'none';
            }).catch(function(error) {
                console.error('Error listing files', error);
                document.getElementById('pdf-container').innerHTML = '<p>התרחשה שגיאה בטעינת הקבצים. אנא נסו שוב מאוחר יותר.</p>';
                document.getElementById('bank-loader').style.display = 'none';
            });
        }
        
        // Handle form submission
        document.getElementById('upload-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const groupName = document.getElementById('group-name').value;
            const fileInput = document.getElementById('pdf-file');
            
            if (fileInput.files.length === 0) {
                alert('אנא בחר קובץ PDF להעלאה.');
                return;
            }
            
            const file = fileInput.files[0];
            
            if (file.type !== 'application/pdf') {
                alert('רק קבצי PDF מורשים להעלאה.');
                return;
            }
            
            document.getElementById('upload-loader').style.display = 'block';
            
            // For a real implementation, you would use the Google Drive API to upload the file
            // Here we're simulating the upload with a timeout
            setTimeout(() => {
                document.getElementById('upload-loader').style.display = 'none';
                document.getElementById('form-section').style.display = 'none';
                document.getElementById('thanks-section').style.display = 'block';
                
                let count = 3;
                const countdownElement = document.getElementById('countdown');
                
                const interval = setInterval(() => {
                    count--;
                    countdownElement.textContent = count;
                    
                    if (count <= 0) {
                        clearInterval(interval);
                        document.getElementById('thanks-section').style.display = 'none';
                        document.getElementById('research-bank').style.display = 'block';
                        listFiles();
                    }
                }, 1000);
            }, 2000);
        });
        
        // Handle bank link click
        document.getElementById('bank-link').addEventListener('click', function(e) {
            e.preventDefault();
            document.getElementById('form-section').style.display = 'none';
            document.getElementById('research-bank').style.display = 'block';
            listFiles();
        });
        
        // Handle back to form button click
        document.getElementById('back-to-form').addEventListener('click', function() {
            document.getElementById('research-bank').style.display = 'none';
            document.getElementById('form-section').style.display = 'block';
        });
        
        // Handle back to list button click
        document.getElementById('back-to-list').addEventListener('click', function() {
            document.getElementById('pdf-viewer').style.display = 'none';
            document.getElementById('pdf-container').style.display = 'grid';
            document.getElementById('back-to-list').style.display = 'none';
        });
        
        // Initialize lava bubbles animation on page load
        document.addEventListener('DOMContentLoaded', createLavaBubbles);
    </script>
    
    <!-- Google API Script (would need actual API keys for production) -->
    <script src="https://apis.google.com/js/api.js"></script>
</body>
</html>
